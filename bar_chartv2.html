<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>D3: Making a bar chart with SVG rects, dynamic widths and spacing</title>
		<script type="text/javascript" src="../d3/d3.js"></script>
		<style type="text/css">
			/* No style rules here yet */		
		</style>
	</head>
	<body>
	
			<defs>
				<linearGradient id="grad2" x1="0%" y1="0%" x2="0%" y2="100%">
				<stop offset="0%" style="stop-color:rgb(255,255,0);stop-opacity:1" />
				<stop offset="100%" style="stop-color:rgb(255,0,0);stop-opacity:1" />
			</linearGradient>
			</defs>
		<script type="text/javascript">

			//Width and height
			var w = 700;
			var h = 900;
			var barPadding = 15;
			
			var dataset = [1128,1015,703,695,687  ];//    ,  675,675,670,665,685,        687.7,691.1,722.2,976,780,        906,913,950,788,889,     892,1005,1022];
			var dataset2 = [1128,1015,703,695,687   ];//   ,  675,675,670,665,685,        687.7,691.1,722.2,976,780,        906,913,950,788,889,     892,1005,1022];
			var years = [1990,1991,1992,1993,1994  ];//  ,1995,1996 ,1997,1998,1999,     2000,2001,2002,2003,2004,     2005,2006,2007,2008,2009,   2010,2011,2012]
			var hgt = h / dataset.length - barPadding
			var borderwidth = 5
			var RunningYL = 0
			var RunningYR= 0 
			var RunningYT=0		
			
			
			
			
			
			//Create SVG element
			var svg = d3.select("body")
						.append("svg")
						.attr("width", w)
						.attr("height", h);

						
						
			svg.selectAll("dataset.rect")
			   .data(dataset)
			   .enter()
			   .append("rect")
			   .attr("y", function(d, i) { RunningYL = RunningYL + Math.abs(Math.cos((-1.04719755+(i-1)*(2.0943951/(dataset.length-1)))))* hgt + Math.abs(Math.cos((-1.04719755+(i)*(2.0943951/(dataset.length)))))*barPadding; return RunningYL;
        })
			   .attr("x", 0)
			   .attr("height", function(d,i) {return  Math.abs(Math.cos((-1.04719755+i*(2.0943951/(dataset.length-1)))))* hgt;})
			   .attr("width", function(d) {    return d*.5;})
			   .attr("fill", "rgba(210,111,11,1.0)")
			   .attr("perspective-origin","top")
			   
			   //.attr("transform","translateY(-100)")
			   .attr("transform","perspective(100)")
			   //.attr("stroke-width", function(d,i) {return  Math.abs(Math.cos((-1.04719755+i*(2.0943951/(dataset.length-1)))))* borderwidth;})
			   //.attr("stroke", "black");		   
			   
			   
			   svg.selectAll("dataset2.rect")
			   .data(dataset2)
			   .enter()
			   .append("rect")
			   .attr("y", function(d, i) { RunningYR = RunningYR + Math.abs(Math.cos((-1.04719755+(i-1)*(2.0943951/(dataset.length-1)))))* hgt + Math.abs(Math.cos((-1.04719755+(i)*(2.0943951/(dataset.length)))))*barPadding;  return RunningYR;
        })
			   .attr("x", function(d) {    return d*.5;})
			   .attr("height", function(d,i) {return  Math.abs(Math.cos((-1.04719755+i*(2.0943951/(dataset.length-1)))))* hgt;})
			   .attr("width", function(d) {  return w- d*.5;})
			   .attr("fill", "rgba(64,64,64,1.0)")
			   //.attr("transform","perspective(100)")
			   
			svg.selectAll("text")
			   .data(years)
			   .enter()
			   .append("text")
			   .text(function(d) {        return d;   })
			   .attr("y", function(d, i) { RunningYT = RunningYT + Math.abs(Math.cos((-1.04719755+(i-1)*(2.0943951/(dataset.length-1)))))* hgt + Math.abs(Math.cos((-1.04719755+(i)*(2.0943951/(dataset.length)))))*barPadding;  return RunningYT;
        })
			   
			   .attr("x", w/2)
			   .attr("font-family", "sans-serif")
			   .attr("font-size", "24px")
			   .attr("text-anchor", "middle");
			   


			
		</script>

	</body>
</html>